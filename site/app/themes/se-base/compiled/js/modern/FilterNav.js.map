{"version":3,"sources":["FilterNav.js"],"names":["FilterNav","[object Object]","el","this","filter_section","filter_links","find","filter_selected","load_more_btn","posts_container","post_type","attr","cat_id","ppp","page","in_ajax","_init_events","on","prepare_ajax","bind","load_more","e","preventDefault","text","$","currentTarget","cat_id_str","parent","parseInt","replace","isNaN","prepare_section","clear","addClass","call_ajax","removeClass","self","data_obj","action","query_vars","ajaxpagination","ajax","url","ajaxurl","type","data","success","html","JSON","parse","append","hide_load_more","show_load_more","resolve_section","hide","show"],"mappings":"AAEA,MAAMA,EAAY,MACdC,YAAYC,GACRC,KAAKC,eAAiBF,EACtBC,KAAKE,aAAeF,KAAKC,eAAeE,KAAK,kBAC7CH,KAAKI,gBAAkBJ,KAAKC,eAAeE,KAAK,0BAChDH,KAAKK,cAAgBL,KAAKC,eAAeE,KAAK,oBAC9CH,KAAKM,gBAAkBN,KAAKC,eAAeE,KAAK,cAChDH,KAAKO,UAAYP,KAAKC,eAAeO,KAAK,kBAC1CR,KAAKS,OAAST,KAAKC,eAAeO,KAAK,YACvCR,KAAKU,IAAM,EACXV,KAAKW,KAAO,EACZX,KAAKY,SAAU,EAEfZ,KAAKa,eAGTf,eACIE,KAAKE,aAAaY,GAAG,QAASd,KAAKe,aAAaC,KAAKhB,OACrDA,KAAKK,cAAcS,GAAG,QAASd,KAAKiB,UAAUD,KAAKhB,OAGvDF,aAAaoB,GAIT,GAFAA,EAAEC,kBAEmB,IAHVnB,KAGFY,QAAmB,CAHjBZ,KAIFY,SAAU,EAJRZ,KAMFI,gBAAgBgB,KAAKC,EAAEH,EAAEI,eAAeF,QAE7C,IAAIG,EAAaF,EAAEH,EAAEI,eAAeE,SAAShB,KAAK,SAC9CC,EAASgB,SAASF,EAAWG,QAAQ,MAAO,IAAK,IAT9C1B,KAWFW,KAAO,EAERgB,MAAMlB,GAbHT,KAcES,QAAS,EAdXT,KAgBES,OAASA,EAhBXT,KAmBFC,eAAeO,KAAK,WAnBlBR,KAmBmCS,QAnBnCT,KAqBF4B,gBArBE5B,KAqBmBU,KAAK,IAKvCZ,gBAAgBY,EAAKmB,GAGjB7B,KAAKC,eAAe6B,SAAS,WAFlB9B,KAIN+B,UAAUrB,EAAKmB,GAGxB/B,kBACeE,KACNY,SAAU,EACfZ,KAAKC,eAAe+B,YAAY,WAGpClC,UAAUY,EAAKmB,GACX,IAAII,EAAOjC,KAEPkC,EAAW,CACXC,OAAQ,kBACRC,WAAYC,eAAeD,WAC3B7B,UAAW0B,EAAK1B,UAChBE,OAAQwB,EAAKxB,OACbC,IAAKA,EACLC,KAAMsB,EAAKtB,MAGfsB,EAAK5B,cAAcyB,SAAS,WAE5BT,EAAEiB,KAAK,CACHC,IAAKF,eAAeG,QACpBC,KAAM,OACNC,KAAMR,EACNS,QAAS,SAASC,GAEd,IAAIV,EAAWW,KAAKC,MAAMF,GAEtBV,EAAe,QAED,IAAVL,EACAI,EAAK3B,gBAAgBsC,KAAKV,EAAe,MAEzCD,EAAK3B,gBAAgByC,OAAOb,EAAe,OAK/CA,EAAoB,YAAMD,EAAKtB,KAC/BsB,EAAKe,iBAELf,EAAKgB,iBAGThB,EAAK5B,cAAc2B,YAAY,WAE/BC,EAAKiB,qBAKjBpD,aAGyB,IAFVE,KAEFY,UAFEZ,KAGFY,SAAU,EAHRZ,KAIFW,OACLX,KAAK4B,gBALE5B,KAKmBU,KAAK,IAIvCZ,iBACeE,KACNK,cAAc8C,OAGvBrD,iBACeE,KACNK,cAAc+C,wBAIZvD","file":"FilterNav.js","sourcesContent":["// import $ from \"cash-dom\";\n\nconst FilterNav = class {\n    constructor(el) {\n        this.filter_section = el;\n        this.filter_links = this.filter_section.find('.filter-list a');\n        this.filter_selected = this.filter_section.find('.filter-list__selected');\n        this.load_more_btn = this.filter_section.find('.post-list__load');\n        this.posts_container = this.filter_section.find('.post-list');\n        this.post_type = this.filter_section.attr('data-post-type');\n        this.cat_id = this.filter_section.attr('data-cat');\n        this.ppp = 6;\n        this.page = 1;\n        this.in_ajax = false;\n\n        this._init_events();\n    }\n\n    _init_events() {\n        this.filter_links.on('click', this.prepare_ajax.bind(this));\n        this.load_more_btn.on('click', this.load_more.bind(this));\n    }\n\n    prepare_ajax(e) {\n        var self = this;\n        e.preventDefault();\n\n        if (self.in_ajax === false) {\n            self.in_ajax = true;\n\n            self.filter_selected.text($(e.currentTarget).text());\n\n            var cat_id_str = $(e.currentTarget).parent().attr('class');\n            var cat_id = parseInt(cat_id_str.replace(/\\D/g, ''), 10);\n\n            self.page = 1;\n\n            if (isNaN(cat_id)) {\n                self.cat_id = false;\n            } else {\n                self.cat_id = cat_id;\n            }\n\n            self.filter_section.attr('data-cat', self.cat_id);\n\n            self.prepare_section(self.ppp, true);\n\n        }\n    }\n\n    prepare_section(ppp, clear) {\n        var self = this;\n\n        this.filter_section.addClass('in-ajax');\n\n        self.call_ajax(ppp, clear);\n    }\n\n    resolve_section() {\n        var self = this;\n        self.in_ajax = false;\n        this.filter_section.removeClass('in-ajax');\n    }\n\n    call_ajax(ppp, clear) {\n        var self = this;\n\n        var data_obj = {\n            action: 'ajax_pagination',\n            query_vars: ajaxpagination.query_vars,\n            post_type: self.post_type,\n            cat_id: self.cat_id,\n            ppp: ppp,\n            page: self.page\n        };\n\n        self.load_more_btn.addClass('loading');\n\n        $.ajax({\n            url: ajaxpagination.ajaxurl,\n            type: 'post',\n            data: data_obj,\n            success: function(html) {\n\n                var data_obj = JSON.parse(html);\n\n                if (data_obj['html']) {\n\n                    if (clear === true) {\n                        self.posts_container.html(data_obj['html']);\n                    } else {\n                        self.posts_container.append(data_obj['html']);\n                    }\n\n                }\n\n                if (data_obj['max_pages'] === self.page) {\n                    self.hide_load_more();\n                } else {\n                    self.show_load_more();\n                }\n\n                self.load_more_btn.removeClass('loading');\n\n                self.resolve_section();\n            }\n        })\n    }\n\n    load_more() {\n        var self = this;\n\n        if (self.in_ajax === false) {\n            self.in_ajax = true;\n            self.page++;\n            this.prepare_section(self.ppp, false);\n        }\n    }\n\n    hide_load_more() {\n        var self = this;\n        self.load_more_btn.hide();\n    }\n\n    show_load_more() {\n        var self = this;\n        self.load_more_btn.show();\n    }\n};\n\nexport default FilterNav;"]}